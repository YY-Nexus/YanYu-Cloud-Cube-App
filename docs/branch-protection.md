# 分支保护规则配置

## 当前配置

本仓库的分支保护规则通过 GitHub API 进行配置，具体配置包括：

### 主要保护规则

1. **必需状态检查**:
   - CI 流水线必须通过 (`"ci"`)
   - 包括：代码检查、类型检查、测试、构建

2. **管理员强制执行**:
   - 管理员也必须遵循分支保护规则 (`enforce_admins=true`)

3. **PR 审查要求**:
   - 当有新提交时自动删除过时的审查 (`dismiss_stale_reviews=true`)

### 配置脚本

分支保护规则通过以下脚本应用：

```bash
scripts/branch-protect-keep.sh
```

该脚本使用 GitHub CLI 对指定仓库列表应用标准化的分支保护设置。

### 验证方法

要验证分支保护是否正确配置，可以：

1. 在 GitHub 仓库页面检查 Settings > Branches
2. 确认 main 分支有适当的保护规则
3. 测试 PR 流程确保规则生效

### 建议改进

1. 添加更详细的状态检查要求
2. 考虑添加代码审查人数要求
3. 配置自动合并条件

## 状态

- ✅ 脚本已准备就绪
- ✅ CI/CD 流水线已配置
- 🔄 需要验证实际应用效果
